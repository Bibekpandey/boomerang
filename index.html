<html>
    <head>
        <title>BoomRang:SinglePlayer Game</title>
        <link rel="stylesheet" type="text/css" href="css/style.css">
        <script src="js/jquery.js"></script>
        <script src="js/objects.js"></script>
    </head>

    <body>
        <div id="heading">
            <h3>BOOMRANG</h3>
        </div>
        <canvas id="game-canvas" width="720" height="480" align="center"> 
        </canvas>
    </body>

    <script>
        var g_tick=0;
        var keys= {}; // pressed keys
        var g_objects = new Array();
        document.onkeydown = function (e) {
            keys[e.which] = true;
         }

         document.onkeyup = function(e) {
             make_movement(bullet);
             keys[e.which]=false;
             //keys={};
         }

        function make_movement(obj) {
            if(keys[37] && keys[38]) {
                obj.x-=5;
                obj.y-=5;
            }else if(keys[39] && keys[38]) {
                obj.x+=5;
                obj.y-=5;
            }else if(keys[37] && keys[40]) {
                obj.x-=5;
                obj.y+=5;
            }else if(keys[39] && keys[40]) {
                obj.x+=5;
                obj.y+=5;
            }
            else if(keys[37])  obj.x-=5;
            else if(keys[38])  obj.y-=5;
            else if(keys[39])  obj.x+=5;
            else if(keys[40])  obj.y+=5;
            else {}
        }


        var numImage = new Image();
        numImage.src = "images/coin.png";
        var bulletImg = new Image();
        bulletImg.src = "images/bullet.png";

        var canvas={};
        canvas.width=720;
        canvas.height=480;

        
        var canvas = document.getElementById("game-canvas");
        var g_context = canvas.getContext("2d");
        var nums = GameObject({
            context:canvas.getContext("2d"),
            width:440,
            height:40,
            numberOfFrames:10,
            image:numImage,
            name:'coin'
        });

        var bullet = GameObject({
            context:canvas.getContext("2d"),
            width:36,
            height:17,
            image:bulletImg,
            numberOfFrames:1,
            name:'bullet'
        });
        var bullet1 = GameObject({
            context:canvas.getContext("2d"),
            width:36,
            height:17,
            image:bulletImg,
            numberOfFrames:1,
            name:'bullet'
        });

        bullet1.x = bullet1.y = 400;
        // modify update
        nums.x = nums.y = 0;
        bullet.x = bullet.y = 50;

        bullet1.update = function() {
            this.x-=0.01;
            this.y-=0.05;
        }

        g_objects.push(bullet);
        g_objects.push(bullet1);
        g_objects.push(nums);

        function gameLoop() {
            g_tick+=1;
            window.requestAnimationFrame(gameLoop);
            g_context.clearRect(0,0,canvas.width, canvas.height);
            for(var x=0;x<g_objects.length;x++) {
                g_objects[x].update();
                g_objects[x].render();
            }
            if(g_tick%2==0){
                //console.log(JSON.stringify(keys));
                make_movement(bullet);
                checkCollision(g_objects);
            }

        }
        numImage.addEventListener("load", gameLoop);
    </script>
</html>
